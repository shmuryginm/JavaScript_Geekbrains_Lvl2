(()=>{"use strict";var t={705:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=t(e);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var s={};if(n)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(s[o]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);n&&s[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),e.push(u))}},e}},772:(t,e,r)=>{r.d(e,{Z:()=>i});var n=r(705),s=r.n(n)()((function(t){return t[1]}));s.push([t.id,"header {\r\n    background:#438f00;\r\n    color:#fff;\r\n    font-weight:bold;\r\n    font-size:100%;\r\n    padding:5px;\r\n}\r\n\r\nbody {\r\n    margin:0;\r\n    padding:0;\r\n    font-family:Courier, Courier New, Andele Mono;\r\n    font-size:100%;\r\n}\r\n\r\nmain {\r\n    padding:15px;\r\n}\r\n\r\nbutton {\r\n    font-family:Courier, Courier New, Andele Mono;\r\n    font-size:100%;\r\n}\r\n\r\np {\r\n    margin:0px;\r\n    padding:0px;\r\n}\r\na {\r\n    color:#4fa800;\r\n    text-decoration: underline;\r\n}\r\nimg {\r\n    padding:0;\r\n    margin:0;\r\n    line-height:0;\r\n    vertical-align:baseline;\r\n}\r\nimg.middle{\r\n    vertical-align:text-top;\r\n}\r\nimg.bottom{\r\n    vertical-align:text-bottom;\r\n}\r\nimg.top{\r\n    vertical-align:top;\r\n}",""]);const i=s},379:(t,e,r)=>{var n,s=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),i=[];function o(t){for(var e=-1,r=0;r<i.length;r++)if(i[r].identifier===t){e=r;break}return e}function c(t,e){for(var r={},n=[],s=0;s<t.length;s++){var c=t[s],u=e.base?c[0]+e.base:c[0],a=r[u]||0,l="".concat(u," ").concat(a);r[u]=a+1;var d=o(l),h={css:c[1],media:c[2],sourceMap:c[3]};-1!==d?(i[d].references++,i[d].updater(h)):i.push({identifier:l,updater:b(h,e),references:1}),n.push(l)}return n}function u(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var i=r.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var o=s(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var a,l=(a=[],function(t,e){return a[t]=e,a.filter(Boolean).join("\n")});function d(t,e,r,n){var s=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=l(e,s);else{var i=document.createTextNode(s),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}function h(t,e,r){var n=r.css,s=r.media,i=r.sourceMap;if(s?t.setAttribute("media",s):t.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var m=null,p=0;function b(t,e){var r,n,s;if(e.singleton){var i=p++;r=m||(m=u(e)),n=d.bind(null,r,i,!1),s=d.bind(null,r,i,!0)}else r=u(e),n=h.bind(null,r,e),s=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else s()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var r=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<r.length;n++){var s=o(r[n]);i[s].references--}for(var u=c(t,e),a=0;a<r.length;a++){var l=o(r[a]);0===i[l].references&&(i[l].updater(),i.splice(l,1))}r=u}}}}},e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={id:n,exports:{}};return t[n](s,s.exports,r),s.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{function t(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class e{constructor(e,r,n){t(this,"_id",void 0),t(this,"_name",void 0),t(this,"_price",void 0),this._id=e,this._name=r,this._price=n}get ID(){return this._id}get Name(){return this._name}get Price(){return this._price}}class n{constructor(){var t,e;e=[],(t="Items")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}getIndexFromID(t){if(0==this.Items.length)return-1;let e=0;for(;e<this.Items.length;){if(this.Items[e].ID==t)return e;e++}return-1}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class i extends n{constructor(t,e){super(),s(this,"_chunkSize",void 0),s(this,"_currentItems",void 0),s(this,"_querySelectorName",void 0),this._querySelectorName=e,this._chunkSize=t,this._currentItems=t}get ChunkSize(){return this._chunkSize}get CurrentItems(){return this._currentItems}get QuerySelectorName(){return this._querySelectorName}_getProducts(){let t=`${document.location.href}database/products.json`;return fetch(t).then((t=>t.json())).then((t=>t.products)).catch((()=>{reject(new Error("Ошибка при получении массива свойств товаров!"))}))}getProductsList(){return new Promise(((t,r)=>{this._getProducts().then((r=>{r=r.map((t=>new e(t.id,t.name,t.price))),this.Items.push(...r),t()})).catch((()=>{r(new Error("Ошибка при обработке массива свойств товаров!"))}))}))}incCurrentItems(){this._currentItems+this._chunkSize<=this.Items.length?this._currentItems+=this._chunkSize:this._currentItems=this.Items.length}_createProductsList(){let t="";for(let e=0;e<this.CurrentItems;e++)t+=`<p>${this.Items[e].Name}, цена: ${this.Items[e].Price} <button type="button" name="btnProductList_${this.Items[e].ID}" value="${this.Items[e].ID}">+</button></p><br>`;return t}render(){let t=document.querySelector("."+this._querySelectorName);if(null!=t){const e=document.createElement("text");e.classList.add("Products");let r=this._createProductsList();t.innerHTML="",e.innerHTML=r,t.appendChild(e)}}}class o extends e{constructor(t,e,r){var n,s;super(t,e,r),s=void 0,(n="_count")in this?Object.defineProperty(this,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[n]=s,this._count=0}get Count(){return this._count}incCount(){this._count++}decCount(){this._count>0&&this._count--}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class u extends n{constructor(t,e){super(),c(this,"_inetShopProductsList",void 0),c(this,"_querySelectorName",void 0),this._inetShopProductsList=t,this._querySelectorName=e}get InetShopProductsList(){return this._inetShopProductsList}addProduct(t){let e=this.getIndexFromID(t);if(-1!=e)return this.Items[e].incCount(),e;e=this._inetShopProductsList.getIndexFromID(t);const r=new o(this._inetShopProductsList.Items[e].ID,this._inetShopProductsList.Items[e].Name,this._inetShopProductsList.Items[e].Price);return r.incCount(),this.Items.push(r),this.Items.length-1}deleteProductElement(t){const e=this.getIndexFromID(t);-1!=e&&(this.Items[e].decCount(),0==this.Items[e].Count&&this.Items.splice(e,1))}deleteProduct(t){const e=this.getIndexFromID(t);-1!=e&&this.Items.splice(e,1)}deleteAllProducts(){this.Items.splice(0,this.Items.length)}_createBasketProductsList(){let t="";return this.Items.forEach((e=>{let r=`<p>${e.Name}, цена: ${e.Price}, кол-во: ${e.Count} <button type = "button" name="btnDeleteElement_${e.ID}" value="${e.ID}">-</button> <button type = "button" name="btnDeleteProduct_${e.ID}" value="${e.ID}">:-(</button></p><br>`;t+=r})),t}render(){let t=document.querySelector("."+this._querySelectorName);if(null!=t){const e=document.createElement("text");e.classList.add("BasketProducts"),t.innerHTML="";let r=this._createBasketProductsList();e.innerHTML=r,t.appendChild(e)}}}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class l{constructor(t,e){a(this,"_countTotal",0),a(this,"_sumTotal",0),a(this,"_querySelectorName",void 0),this._basketProductsList=t,this._querySelectorName=e}get BasketProductsList(){return this._basketProductsList}get CountTotal(){return this._countTotal}get SumTotal(){return this._sumTotal}_calculate(){this._countTotal=0,this._sumTotal=0,0!=this._basketProductsList.Items.length&&this._basketProductsList.Items.forEach((t=>{this._countTotal+=t.Count,this._sumTotal+=t.Price*t.Count}))}render(){this._calculate();let t=document.querySelector("."+this._querySelectorName);if(null!=t){const e=document.createElement("text");e.classList.add("BasketInfo"),t.innerHTML="";let r=`Количество товаров: ${this.CountTotal} на сумму: ${this.SumTotal}`;e.innerHTML=r,t.appendChild(e)}}}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class h{constructor(t,e){d(this,"_basketProductsList",void 0),d(this,"_basket",void 0),this._basketProductsList=t,this._basket=e}get BasketProductsList(){return this._basketProductsList}get Basket(){return this._basket}click(){this._basketProductsList.render(),this._basket.render()}}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class p extends h{constructor(t,e,r,n){super(r,n),m(this,"_productID",void 0),m(this,"_inetShopProductsList",void 0),m(this,"_index",void 0),this._productID=t,this._inetShopProductsList=e,this._index=this._inetShopProductsList.getIndexFromID(this._productID)}get ProductID(){return this._productID}get InetShopProductsList(){return this._interShopProductsList}get Index(){return this._index}click(){this.BasketProductsList.addProduct(this._productID),super.click()}}class b extends h{constructor(t,e){super(t,e)}click(){super.BasketProductsList.deleteAllProducts(),super.click()}}class _ extends h{constructor(t,e,r){var n;super(e,r),n=void 0,"_id"in this?Object.defineProperty(this,"_id",{value:n,enumerable:!0,configurable:!0,writable:!0}):this._id=n,this._id=t}get ID(){return this._id}click(){super.BasketProductsList.deleteProductElement(this._id),super.click()}}class f extends h{constructor(t,e,r){var n;super(e,r),n=void 0,"_id"in this?Object.defineProperty(this,"_id",{value:n,enumerable:!0,configurable:!0,writable:!0}):this._id=n,this._id=t}get ID(){return this._id}click(){super.BasketProductsList.deleteProduct(this._id),super.click()}}var P=r(379),v=r.n(P),g=r(772);function k(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}v()(g.Z,{insert:"head",singleton:!1}),g.Z.locals;class I{static _prepareShopObjects(){this.interShopProductsList=new i(2,"productsList"),this.basketProductsList=new u(this.interShopProductsList,"basketList"),this.basket=new l(this.basketProductsList,"basket")}static _addtoBasket(t){return new Promise(((e,r)=>{new p(t,this.interShopProductsList,this.basketProductsList,this.basket).click(),e()}))}static OnBtnAddToBasketClick(t){this._addtoBasket(t).then((()=>{this._setHandlersForBasketButtons()}))}static _deleteProductElement(t){return new Promise(((e,r)=>{new _(t,this.basketProductsList,this.basket).click(),e()}))}static OnBtnDeleteProductElementClick(t){this._deleteProductElement(t).then((()=>{this._setHandlersForBasketButtons()}))}static _deleteProduct(t){return new Promise(((e,r)=>{new f(t,this.basketProductsList,this.basket).click(),e()}))}static OnBtnDeleteProductClick(t){this._deleteProduct(t).then((()=>{this._setHandlersForBasketButtons()}))}static _setHandlersForBasketButtons(){this.basketProductsList.Items.forEach((t=>{let e=t.ID,r=document.getElementsByName(this._btnDeleteProductElementName+"_"+e)[0];null!=r&&r.addEventListener("click",(()=>{this.OnBtnDeleteProductElementClick(r.value)})),r=document.getElementsByName(this._btnDeleteProductName+"_"+e)[0],null!=r&&r.addEventListener("click",(()=>{this.OnBtnDeleteProductClick(r.value)}))}))}static _deleteAllProducts(){return new Promise(((t,e)=>{new b(this.basketProductsList,this.basket).click(),t()}))}static OnBtnDeleteAllProducts(){this._deleteAllProducts().then((()=>{this.basket.render()}))}static OnBtnGetNextChunkProducts(){this.interShopProductsList.incCurrentItems(),this.interShopProductsList.CurrentItems<=this.interShopProductsList.Items.length&&(this.interShopProductsList.render(),this._setHandlerForProductsListButtons())}static _setHandlerForProductsListButtons(){for(let t=0;t<this.interShopProductsList.CurrentItems;t++){let e=this.interShopProductsList.Items[t].ID,r=document.getElementsByName(this._btnInetShopProductsName+"_"+e)[0];null!=r?r.addEventListener("click",(()=>{this.OnBtnAddToBasketClick(r.value)})):console.error("Нет конпки "+this._btnInetShopProductsName+"_"+e)}}static _setHandlerForDeleteAllProductsButtons(){let t=document.getElementsByName(this._btnDeleteAllProductsName)[0];null!=t&&t.addEventListener("click",(()=>{this.OnBtnDeleteAllProducts()}))}static _setHandlerForGetNextChunkProductsButtons(){let t=document.getElementsByName(this._btnGetNextChunkName)[0];null!=t&&t.addEventListener("click",(()=>{this.OnBtnGetNextChunkProducts()}))}static main(){try{this._prepareShopObjects(),this.interShopProductsList.getProductsList().then((()=>{this.interShopProductsList.render(),this._setHandlerForProductsListButtons()})).catch((t=>{console.error("Основной модуль!",t)})),this._setHandlerForGetNextChunkProductsButtons(),this.basket.render(),this._setHandlerForDeleteAllProductsButtons()}catch(t){console.error(t)}}}k(I,"_btnInetShopProductsName","btnProductList"),k(I,"_btnDeleteProductElementName","btnDeleteElement"),k(I,"_btnDeleteProductName","btnDeleteProduct"),k(I,"_btnDeleteAllProductsName","ClearBasket"),k(I,"_btnGetNextChunkName","btnAddNextChunk"),k(I,"interShopProductsList",void 0),k(I,"basketProductsList",void 0),k(I,"basket",void 0),I.main()})()})();