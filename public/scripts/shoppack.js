(()=>{"use strict";var t={705:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=t(e);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,s){"string"==typeof t&&(t=[[null,t,""]]);var n={};if(s)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(n[o]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);s&&n[u[0]]||(r&&(u[2]?u[2]="".concat(r," and ").concat(u[2]):u[2]=r),e.push(u))}},e}},772:(t,e,r)=>{r.d(e,{Z:()=>i});var s=r(705),n=r.n(s)()((function(t){return t[1]}));n.push([t.id,"header {\r\n    background:#438f00;\r\n    color:#fff;\r\n    font-weight:bold;\r\n    font-size:100%;\r\n    padding:5px;\r\n}\r\n\r\nbody {\r\n    margin:0;\r\n    padding:0;\r\n    font-family:Courier, Courier New, Andele Mono;\r\n    font-size:100%;\r\n}\r\n\r\nmain {\r\n    padding:15px;\r\n}\r\n\r\nbutton {\r\n    font-family:Courier, Courier New, Andele Mono;\r\n    font-size:100%;\r\n}\r\n\r\np {\r\n    margin:0px;\r\n    padding:0px;\r\n}\r\na {\r\n    color:#4fa800;\r\n    text-decoration: underline;\r\n}\r\nimg {\r\n    padding:0;\r\n    margin:0;\r\n    line-height:0;\r\n    vertical-align:baseline;\r\n}\r\nimg.middle{\r\n    vertical-align:text-top;\r\n}\r\nimg.bottom{\r\n    vertical-align:text-bottom;\r\n}\r\nimg.top{\r\n    vertical-align:top;\r\n}",""]);const i=n},379:(t,e,r)=>{var s,n=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),i=[];function o(t){for(var e=-1,r=0;r<i.length;r++)if(i[r].identifier===t){e=r;break}return e}function c(t,e){for(var r={},s=[],n=0;n<t.length;n++){var c=t[n],u=e.base?c[0]+e.base:c[0],a=r[u]||0,d="".concat(u," ").concat(a);r[u]=a+1;var l=o(d),h={css:c[1],media:c[2],sourceMap:c[3]};-1!==l?(i[l].references++,i[l].updater(h)):i.push({identifier:d,updater:P(h,e),references:1}),s.push(d)}return s}function u(t){var e=document.createElement("style"),s=t.attributes||{};if(void 0===s.nonce){var i=r.nc;i&&(s.nonce=i)}if(Object.keys(s).forEach((function(t){e.setAttribute(t,s[t])})),"function"==typeof t.insert)t.insert(e);else{var o=n(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(e)}return e}var a,d=(a=[],function(t,e){return a[t]=e,a.filter(Boolean).join("\n")});function l(t,e,r,s){var n=r?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(t.styleSheet)t.styleSheet.cssText=d(e,n);else{var i=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}function h(t,e,r){var s=r.css,n=r.media,i=r.sourceMap;if(n?t.setAttribute("media",n):t.removeAttribute("media"),i&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}var m=null,p=0;function P(t,e){var r,s,n;if(e.singleton){var i=p++;r=m||(m=u(e)),s=l.bind(null,r,i,!1),n=l.bind(null,r,i,!0)}else r=u(e),s=h.bind(null,r,e),n=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else n()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s));var r=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var s=0;s<r.length;s++){var n=o(r[s]);i[n].references--}for(var u=c(t,e),a=0;a<r.length;a++){var d=o(r[a]);0===i[d].references&&(i[d].updater(),i.splice(d,1))}r=u}}}}},e={};function r(s){if(e[s])return e[s].exports;var n=e[s]={id:s,exports:{}};return t[s](n,n.exports,r),n.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{class t{constructor(){var t,e;e=[],(t="Items")in this?Object.defineProperty(this,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):this[t]=e}getIndexFromID(t){if(0==this.Items.length)return-1;let e=0;for(;e<this.Items.length;){if(this.Items[e].ID==t)return e;e++}return-1}}function e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class s extends t{constructor(t,r){super(),e(this,"_chunkSize",void 0),e(this,"_currentItems",void 0),e(this,"_querySelectorName",void 0),this._querySelectorName=r,this._chunkSize=t,this._currentItems=t}get ChunkSize(){return this._chunkSize}get CurrentItems(){return this._currentItems}get QuerySelectorName(){return this._querySelectorName}_getProducts(){return fetch("/database/products.json").then((t=>t.json())).then((t=>t.products))}getProductsList(){return new Promise((t=>{this._getProducts().then((e=>{e=e.map((t=>new InetShopProduct(t.id,t.name,t.price))),this.Items.push(...e),t()}))}))}incCurrentItems(){this._currentItems+this._chunkSize<=this.Items.length?this._currentItems+=this._chunkSize:this._currentItems=this.Items.length}_createProductsList(){let t="";for(let e=0;e<this.CurrentItems;e++)t+=`<p>${this.Items[e].Name}, цена: ${this.Items[e].Price} <button type="button" name="btnProductList_${this.Items[e].ID}" value="${this.Items[e].ID}">+</button></p><br>`;return t}render(){let t=document.querySelector("."+this._querySelectorName);if(null!=t){const e=document.createElement("text");e.classList.add("Products");let r=this._createProductsList();t.innerHTML="",e.innerHTML=r,t.appendChild(e)}}}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class i extends t{constructor(t,e){super(),n(this,"_inetShopProductsList",void 0),n(this,"_querySelectorName",void 0),this._inetShopProductsList=t,this._querySelectorName=e}get InetShopProductsList(){return this._inetShopProductsList}addProduct(t){let e=this.getIndexFromID(t);if(-1!=e)return this.Items[e].incCount(),e;e=this._inetShopProductsList.getIndexFromID(t);const r=new BasketProduct(this._inetShopProductsList.Items[e].ID,this._inetShopProductsList.Items[e].Name,this._inetShopProductsList.Items[e].Price);return r.incCount(),this.Items.push(r),this.Items.length-1}deleteProductElement(t){const e=this.getIndexFromID(t);-1!=e&&(this.Items[e].decCount(),0==this.Items[e].Count&&this.Items.splice(e,1))}deleteProduct(t){const e=this.getIndexFromID(t);-1!=e&&this.Items.splice(e,1)}deleteAllProducts(){this.Items.splice(0,this.Items.length)}_createBasketProductsList(){let t="";return this.Items.forEach((e=>{let r=`<p>${e.Name}, цена: ${e.Price}, кол-во: ${e.Count} <button type = "button" name="btnDeleteElement_${e.ID}" value="${e.ID}">-</button> <button type = "button" name="btnDeleteProduct_${e.ID}" value="${e.ID}">:-(</button></p><br>`;t+=r})),t}render(){let t=document.querySelector("."+this._querySelectorName);if(null!=t){const e=document.createElement("text");e.classList.add("BasketProducts"),t.innerHTML="";let r=this._createBasketProductsList();e.innerHTML=r,t.appendChild(e)}}}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}class c{constructor(t,e){o(this,"_countTotal",0),o(this,"_sumTotal",0),o(this,"_querySelectorName",void 0),this._basketProductsList=t,this._querySelectorName=e}get BasketProductsList(){return this._basketProductsList}get CountTotal(){return this._countTotal}get SumTotal(){return this._sumTotal}_calculate(){this._countTotal=0,this._sumTotal=0,0!=this._basketProductsList.Items.length&&this._basketProductsList.Items.forEach((t=>{this._countTotal+=t.Count,this._sumTotal+=t.Price*t.Count}))}render(){this._calculate();let t=document.querySelector("."+this._querySelectorName);if(null!=t){const e=document.createElement("text");e.classList.add("BasketInfo"),t.innerHTML="";let r=`Количество товаров: ${this.CountTotal} на сумму: ${this.SumTotal}`;e.innerHTML=r,t.appendChild(e)}}}var u=r(379),a=r.n(u),d=r(772);function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}a()(d.Z,{insert:"head",singleton:!1}),d.Z.locals;class h{constructor(t,e){l(this,"_basketProductsList",void 0),l(this,"_basket",void 0),this._basketProductsList=t,this._basket=e}get BasketProductsList(){return this._basketProductsList}get Basket(){return this._basket}click(){this._basketProductsList.render(),this._basket.render()}}class m extends h{constructor(t,e,r,s){super(r,s),l(this,"_productID",void 0),l(this,"_inetShopProductsList",void 0),l(this,"_index",void 0),this._productID=t,this._inetShopProductsList=e,this._index=this._inetShopProductsList.getIndexFromID(this._productID)}get ProductID(){return this._productID}get InetShopProductsList(){return this._interShopProductsList}get Index(){return this._index}click(){this.BasketProductsList.addProduct(this._productID),super.click()}}class p extends h{constructor(t,e){super(t,e)}click(){super.BasketProductsList.deleteAllProducts(),super.click()}}class P extends h{constructor(t,e,r){super(e,r),l(this,"_id",void 0),this._id=t}get ID(){return this._id}click(){super.BasketProductsList.deleteProductElement(this._id),super.click()}}class _ extends h{constructor(t,e,r){super(e,r),l(this,"_id",void 0),this._id=t}get ID(){return this._id}click(){super.BasketProductsList.deleteProduct(this._id),super.click()}}class b{static _prepareShopObjects(){this.interShopProductsList=new s(2,"productsList"),this.basketProductsList=new i(this.interShopProductsList,"basketList"),this.basket=new c(this.basketProductsList,"basket")}static _addtoBasket(t){return new Promise(((e,r)=>{new m(t,this.interShopProductsList,this.basketProductsList,this.basket).click(),e()}))}static OnBtnAddToBasketClick(t){this._addtoBasket(t).then((()=>{this._setHandlersForBasketButtons()}))}static _deleteProductElement(t){return new Promise(((e,r)=>{new P(t,this.basketProductsList,this.basket).click(),e()}))}static OnBtnDeleteProductElementClick(t){this._deleteProductElement(t).then((()=>{this._setHandlersForBasketButtons()}))}static _deleteProduct(t){return new Promise(((e,r)=>{new _(t,this.basketProductsList,this.basket).click(),e()}))}static OnBtnDeleteProductClick(t){this._deleteProduct(t).then((()=>{this._setHandlersForBasketButtons()}))}static _deleteAllProducts(){return new Promise(((t,e)=>{new p(this.basketProductsList,this.basket).click(),t()}))}static OnBtnDeleteAllProducts(){this._deleteAllProducts().then((()=>{this.basket.render()}))}static OnBtnGetNextChunkProducts(){this.interShopProductsList.incCurrentItems(),this.interShopProductsList.CurrentItems<=this.interShopProductsList.Items.length&&this.interShopProductsList.getProductsList().then((()=>{this.interShopProductsList.render(),this._setHandlerForProductsListButtons()}))}static _setHandlerForProductsListButtons(){for(let t=0;t<this.interShopProductsList.CurrentItems;t++){let e=this.interShopProductsList.Items[t].ID,r=document.getElementsByName(this._btnInetShopProductsName+"_"+e)[0];null!=r&&r.addEventListener("click",(()=>{this.OnBtnAddToBasketClick(r.value)}))}}static _setHandlersForBasketButtons(){this.basketProductsList.Items.forEach((t=>{let e=t.ID,r=document.getElementsByName(this._btnDeleteProductElementName+"_"+e)[0];null!=r&&r.addEventListener("click",(()=>{this.OnBtnDeleteProductElementClick(r.value)})),r=document.getElementsByName(this._btnDeleteProductName+"_"+e)[0],null!=r&&r.addEventListener("click",(()=>{this.OnBtnDeleteProductClick(r.value)}))}))}static _setHandlerForDeleteAllProductsButtons(){let t=document.getElementsByName(this._btnDeleteAllProductsName)[0];null!=t&&t.addEventListener("click",(()=>{this.OnBtnDeleteAllProducts()}))}static _setHandlerForGetNextChunkProductsButtons(){let t=document.getElementsByName(this._btnGetNextChunkName)[0];null!=t&&t.addEventListener("click",(()=>{this.OnBtnGetNextChunkProducts()}))}static main(){try{this._prepareShopObjects(),this.interShopProductsList.getProductsList().then((()=>{this.interShopProductsList.render(),this._setHandlerForProductsListButtons()})),this._setHandlerForGetNextChunkProductsButtons(),this.basket.render(),this._setHandlerForDeleteAllProductsButtons()}catch(t){console.error(t)}}}l(b,"_btnInetShopProductsName","btnProductList"),l(b,"_btnDeleteProductElementName","btnDeleteElement"),l(b,"_btnDeleteProductName","btnDeleteProduct"),l(b,"_btnDeleteAllProductsName","ClearBasket"),l(b,"_btnGetNextChunkName","btnAddNextChunk"),l(b,"interShopProductsList",void 0),l(b,"basketProductsList",void 0),l(b,"basket",void 0),b.main()})()})();